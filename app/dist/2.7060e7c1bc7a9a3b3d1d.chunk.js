webpackJsonp([2],{CYEl:function(e,l,t){"use strict";Object.defineProperty(l,"__esModule",{value:!0});var n=t("LMZF"),o=t("UHIZ"),a=t("oKOW"),i=t("Xtjv"),r=t("TMwh"),u=t("Dqrr"),p=t("JYV8"),d=t("p5Ee"),c=function(){function e(e,l,t){this.http=e,this.router=l,this.api=t,this.apiUrl=d.a.pdfUrl}return e.prototype.createAuthorizationHeader=function(e){},e.prototype.get=function(e,l){console.log("GET"+this.apiUrl);var t=new r.d;this.createAuthorizationHeader(t);var n=new r.i;if(l)for(var o in l)n.set(o,l[o]);return this.http.get(this.apiUrl+e,{headers:t,search:n}).map(function(e){return e.json()}).catch(this.handleError)},e.prototype.post=function(e,l){var t=new r.d;return this.createAuthorizationHeader(t),this.http.post(e,l,{headers:t}).map(function(e){return e.json()}).catch(this.handleError)},e.prototype.put=function(e,l){var t=new r.d;return this.createAuthorizationHeader(t),this.http.put(this.apiUrl+e,l,{headers:t}).map(function(e){return e.json()}).catch(this.handleError)},e.prototype.patch=function(e,l){var t=new r.d;return this.createAuthorizationHeader(t),this.http.patch(this.apiUrl+e,l,{headers:t}).map(function(e){return e.json()}).catch(this.handleError)},e.prototype.delete=function(e){var l=new r.d;return this.createAuthorizationHeader(l),this.http.delete(this.apiUrl+e,{headers:l}).map(function(e){return e.json()}).catch(this.handleError)},e.prototype.handleError=function(e){return u.Observable.throw(e)},e.prototype.getTemplates=function(){return this.api.get("/Templates")},e.prototype.deleteTemplate=function(e){return this.delete("/Templates/"+e)},e.prototype.downloadTemplate=function(e,l,t){var n=new r.d;return n.append("token",t),this.http.post(e,{data:l},{headers:n}).map(function(e){return e.json()}).catch(this.handleError)},e}(),s=t("efqP"),m=function(){function e(e,l,t,n,o){this.route=e,this.router=l,this.api=t,this.wineApi=n,this.settings=o,this.templates=[],this.mimeTypes=["image/jpeg"]}return e.prototype.ngOnInit=function(){var e=this;this.uploader=new a.FileUploader({url:d.a.pdfUrl+"/Templates/",authToken:this.settings.getStorage("userId")}),this.uploader.onSuccessItem=function(l,t,n,o){e.uploader.clearQueue(),e.templates.push(JSON.parse(t))},this.uploader.onErrorItem=function(l,t,n,o){alert("Sorry. file uploading failed"),e.uploader.clearQueue()},this.uploader.onWhenAddingFileFailed=function(e,l){console.log(e),console.log(l),"mimeType"===l.name&&alert("Invalid file")},this.uploader.onAfterAddingFile=function(l){l.withCredentials=!1,e.uploader.uploadAll()},this.api.get("/Templates").subscribe(function(l){var t=e.settings.getStorage("userId");e.templates=l.filter(function(e){return e.ownerId===t})})},e.prototype.downloadTemplate=function(e){var l=this;this.wineApi.getAll().subscribe(function(t){var n={red:{normal:[],little:[],premium:[]},white:{normal:[],little:[],premium:[]},rose:{normal:[],little:[],premium:[]},champagne:{normal:[],little:[],premium:[]}};t.forEach(function(e){n[e.type]&&(e.no=e.no||"",e.price=e.price&&e.price.toFixed(2),e.alcohol&&(e.alcohol+=" %"),.75==e.content&&(e.price1=e.price,e.price=(100*e.price/75).toFixed(2)),e.premium?n[e.type].premium.push(e):.75==e.content?n[e.type].little.push(e):n[e.type].normal.push(e))}),l.api.downloadTemplate(d.a.pdfUrl+"/Templates/"+e.id,JSON.stringify(n),l.settings.getStorage("userId")).subscribe(function(e){window.open("https://"+e,"_blank")})})},e.prototype.deleteTemplate=function(e){var l=this;confirm("Are you sure to delete")&&this.api.deleteTemplate(e.id).subscribe(function(t){l.templates=l.templates.filter(function(l){return l.id!=e.id})})},e.prototype.selectFile=function(){$("#templateFile").trigger("click")},e}(),h=function(){},f=t("LdGb"),g=t("TRAr"),b=t("e7TK"),v=t("M3Sp"),y=t("Un6q"),w=t("X68L"),F=n["\u0275crt"]({encapsulation:2,styles:[["app-template-page .c-template{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;position:relative;width:250px;height:420px;-ms-flex-preferred-size:12%;flex-basis:12%;padding:2%;background-color:#fff;-webkit-box-shadow:0 0 1px 0 rgba(0,0,0,.25);box-shadow:0 0 1px 0 rgba(0,0,0,.25);color:#333}app-template-page .c-template:hover{text-decoration:none}app-template-page .c-template h4{height:60px}app-template-page .c-template .image img{display:block;margin:0 auto;max-height:25vh}app-template-page .c-template .description{margin-top:auto;padding-top:20px;text-align:center}"]],data:{}});function x(e){return n["\u0275vid"](0,[(e()(),n["\u0275eld"](0,0,null,null,5,"div",[["class","progress my-2"]],null,null,null,null,null)),(e()(),n["\u0275ted"](-1,null,["\n    "])),(e()(),n["\u0275eld"](2,0,null,null,2,"div",[["class","progress-bar"]],null,null,null,null,null)),n["\u0275did"](3,278528,null,0,y.NgStyle,[n.KeyValueDiffers,n.ElementRef,n.Renderer2],{ngStyle:[0,"ngStyle"]},null),n["\u0275pod"](4,{width:0}),(e()(),n["\u0275ted"](-1,null,["\n  "]))],function(e,l){e(l,3,0,e(l,4,0,l.context.$implicit.progress+"%"))},null)}function T(e){return n["\u0275vid"](0,[(e()(),n["\u0275eld"](0,0,null,null,10,"div",[["class","d-flex mb-2"]],null,null,null,null,null)),(e()(),n["\u0275ted"](-1,null,["\n    "])),(e()(),n["\u0275eld"](2,0,null,null,1,"span",[],null,null,null,null,null)),(e()(),n["\u0275ted"](3,null,["\n      ","\n    "])),(e()(),n["\u0275ted"](-1,null,["\n    "])),(e()(),n["\u0275eld"](5,0,null,null,1,"button",[["class","btn btn-success btn-sm ml-auto"]],null,[[null,"click"]],function(e,l,t){var n=!0;return"click"===l&&(n=!1!==e.component.downloadTemplate(e.context.$implicit)&&n),n},null,null)),(e()(),n["\u0275ted"](-1,null,["Download"])),(e()(),n["\u0275ted"](-1,null,["\n    "])),(e()(),n["\u0275eld"](8,0,null,null,1,"button",[["class","btn btn-danger btn-sm ml-2"]],null,[[null,"click"]],function(e,l,t){var n=!0;return"click"===l&&(n=!1!==e.component.deleteTemplate(e.context.$implicit)&&n),n},null,null)),(e()(),n["\u0275ted"](-1,null,["Delete"])),(e()(),n["\u0275ted"](-1,null,["\n  "]))],null,function(e,l){e(l,3,0,l.context.$implicit.originalFilename||l.context.$implicit.name)})}function k(e){return n["\u0275vid"](0,[(e()(),n["\u0275eld"](0,0,null,null,24,"div",[["class","container"]],null,null,null,null,null)),(e()(),n["\u0275ted"](-1,null,["\n  "])),(e()(),n["\u0275eld"](2,0,null,null,7,"h3",[["class","mt-4"]],null,null,null,null,null)),(e()(),n["\u0275ted"](-1,null,["\n    "])),(e()(),n["\u0275eld"](4,0,null,null,1,"span",[["class","text-capitalize"]],null,null,null,null,null)),(e()(),n["\u0275ted"](-1,null,["Templates"])),(e()(),n["\u0275ted"](-1,null,["\n    "])),(e()(),n["\u0275eld"](7,0,null,null,1,"button",[["class","btn btn-primary btn-sm"]],null,[[null,"click"]],function(e,l,t){var n=!0;return"click"===l&&(n=!1!==e.component.selectFile()&&n),n},null,null)),(e()(),n["\u0275ted"](-1,null,["Upload"])),(e()(),n["\u0275ted"](-1,null,["\n  "])),(e()(),n["\u0275ted"](-1,null,["\n\n  "])),(e()(),n["\u0275eld"](11,0,null,null,1,"input",[["class","file d-none"],["id","templateFile"],["ng2FileSelect",""],["type","file"]],null,[[null,"change"]],function(e,l,t){var o=!0;return"change"===l&&(o=!1!==n["\u0275nov"](e,12).onChange()&&o),o},null,null)),n["\u0275did"](12,16384,null,0,w.FileSelectDirective,[n.ElementRef],{uploader:[0,"uploader"]},null),(e()(),n["\u0275ted"](-1,null,["\n  "])),n["\u0275ncd"](null,0),(e()(),n["\u0275ted"](-1,null,["\n  "])),(e()(),n["\u0275and"](16777216,null,null,1,null,x)),n["\u0275did"](17,802816,null,0,y.NgForOf,[n.ViewContainerRef,n.TemplateRef,n.IterableDiffers],{ngForOf:[0,"ngForOf"]},null),(e()(),n["\u0275ted"](-1,null,["\n\n  "])),(e()(),n["\u0275and"](16777216,null,null,1,null,T)),n["\u0275did"](20,802816,null,0,y.NgForOf,[n.ViewContainerRef,n.TemplateRef,n.IterableDiffers],{ngForOf:[0,"ngForOf"]},null),(e()(),n["\u0275ted"](-1,null,["\n\n  "])),(e()(),n["\u0275eld"](22,0,null,null,1,"div",[["class","text-center"]],[[8,"hidden",0]],null,null,null,null)),(e()(),n["\u0275ted"](-1,null,["\n    No templates uploaded.\n  "])),(e()(),n["\u0275ted"](-1,null,["\n\n"]))],function(e,l){var t=l.component;e(l,12,0,t.uploader),e(l,17,0,t.uploader.queue),e(l,20,0,t.templates)},function(e,l){e(l,22,0,l.component.templates.length)})}var A=n["\u0275ccf"]("app-template-page",m,function(e){return n["\u0275vid"](0,[(e()(),n["\u0275eld"](0,0,null,null,1,"app-template-page",[],null,null,null,k,F)),n["\u0275did"](1,114688,null,0,m,[o.a,o.k,c,s.a,i.a],null,null)],function(e,l){e(l,1,0)},null)},{mimeTypes:"mimeTypes"},{},["*"]),R=t("0nO6"),U=t("iz04"),E=t("BhHz"),M=t("poDJ"),S=t("PK6g"),I=t("4zAq"),z=t("/XUI"),C=t("Xu3G"),O=t("2S4b"),N=t("eAzq"),j=t("Hw/e"),D=t("x/Up"),H=t("EQxj"),L=t("bIam"),q=t("Xuu1"),J=t("Nv++"),X=t("T2Au"),B=t("pBJ6");t.d(l,"TemplateModuleNgFactory",function(){return K});var K=n["\u0275cmf"](h,[],function(e){return n["\u0275mod"]([n["\u0275mpd"](512,n.ComponentFactoryResolver,n["\u0275CodegenComponentFactoryResolver"],[[8,[f.a,g.a,b.a,v.a,A]],[3,n.ComponentFactoryResolver],n.NgModuleRef]),n["\u0275mpd"](4608,y.NgLocalization,y.NgLocaleLocalization,[n.LOCALE_ID,[2,y["\u0275a"]]]),n["\u0275mpd"](4608,R["\u0275i"],R["\u0275i"],[]),n["\u0275mpd"](4608,R.FormBuilder,R.FormBuilder,[]),n["\u0275mpd"](4608,U.e,U.e,[]),n["\u0275mpd"](4608,E.a,E.a,[]),n["\u0275mpd"](4608,M.a,M.a,[n.ComponentFactoryResolver,n.NgZone,n.Injector,E.a,n.ApplicationRef]),n["\u0275mpd"](4608,S.a,S.a,[n.RendererFactory2,M.a]),n["\u0275mpd"](4608,I.a,I.a,[]),n["\u0275mpd"](4608,z.a,z.a,[]),n["\u0275mpd"](4608,C.a,C.a,[o.k,i.a,O.a]),n["\u0275mpd"](4608,s.a,s.a,[p.a]),n["\u0275mpd"](4608,c,c,[r.e,o.k,p.a]),n["\u0275mpd"](512,y.CommonModule,y.CommonModule,[]),n["\u0275mpd"](512,R["\u0275ba"],R["\u0275ba"],[]),n["\u0275mpd"](512,R.FormsModule,R.FormsModule,[]),n["\u0275mpd"](512,R.ReactiveFormsModule,R.ReactiveFormsModule,[]),n["\u0275mpd"](512,o.n,o.n,[[2,o.s],[2,o.k]]),n["\u0275mpd"](512,U.a,U.a,[]),n["\u0275mpd"](512,N.SelectModule,N.SelectModule,[]),n["\u0275mpd"](512,j.FileUploadModule,j.FileUploadModule,[]),n["\u0275mpd"](512,D.a,D.a,[]),n["\u0275mpd"](512,H.a,H.a,[]),n["\u0275mpd"](512,L.a,L.a,[]),n["\u0275mpd"](512,q.a,q.a,[]),n["\u0275mpd"](512,J.a,J.a,[]),n["\u0275mpd"](512,X.a,X.a,[]),n["\u0275mpd"](512,h,h,[]),n["\u0275mpd"](256,B.a,{autoClose:!0},[]),n["\u0275mpd"](1024,o.i,function(){return[[{path:"",component:m}]]},[])])})}});